module.exports=[56704,(a,b,c)=>{b.exports=a.x("next/dist/server/app-render/work-async-storage.external.js",()=>require("next/dist/server/app-render/work-async-storage.external.js"))},32319,(a,b,c)=>{b.exports=a.x("next/dist/server/app-render/work-unit-async-storage.external.js",()=>require("next/dist/server/app-render/work-unit-async-storage.external.js"))},20635,(a,b,c)=>{b.exports=a.x("next/dist/server/app-render/action-async-storage.external.js",()=>require("next/dist/server/app-render/action-async-storage.external.js"))},78830,(a,b,c)=>{"use strict";b.exports=a.r(30770).vendored.contexts.AppRouterContext},58975,(a,b,c)=>{"use strict";b.exports=a.r(30770).vendored.contexts.HooksClientContext},47308,(a,b,c)=>{"use strict";b.exports=a.r(30770).vendored.contexts.ServerInsertedHtml},42133,a=>{"use strict";var b=a.i(14046),c=a.i(98154),d=a.i(88572),e=a.i(95407),f=a.i(46749),g=a.i(69976),h=a.i(45589),i=a.i(13589),j=a.i(29735),k=a.i(82496),l=a.i(15890),m=a.i(30952);let n=(0,f.forwardRef)((a,n)=>{let o;var{children:p,titleBadge:q,hint:r,subhead:s,subtitle:t,description:u,className:v,before:w,after:x,Component:y,hovered:z,multiline:A}=a,B=(0,d._)(a,["children","titleBadge","hint","subhead","subtitle","description","className","before","after","Component","hovered","multiline"]);let C=(0,i.usePlatform)(),{Title:D,Description:E}=(o="ios"===(0,i.usePlatform)(),{Title:(0,f.useCallback)(a=>o?(0,e.jsx)(m.Text,(0,b._)({},a)):(0,e.jsx)(k.Subheadline,(0,b._)({level:"1"},a)),[o]),Description:(0,f.useCallback)(a=>o?(0,e.jsx)(l.Caption,(0,b._)({},a)):(0,e.jsx)(k.Subheadline,(0,b._)({level:"2"},a)),[o])}),F=(0,h.hasReactNode)(p)||(0,h.hasReactNode)(r)||(0,h.hasReactNode)(q);return(0,e.jsxs)(j.Tappable,(0,c._)((0,b._)({ref:n,Component:y||"div",className:(0,g.classNames)("tgui-b8dfba0b5c3d054c","ios"===C&&"tgui-7b5bccbb645b495f",z&&"tgui-7edaaf0c57797623",A&&"tgui-6c49dadccf648a5b",v)},B),{children:[(0,h.hasReactNode)(w)&&(0,e.jsx)("div",{className:"tgui-aaa795d78c356ac1",children:w}),(0,e.jsxs)("div",{className:"tgui-8735a62be5a8b8a7",children:[(0,h.hasReactNode)(s)&&(0,e.jsx)(k.Subheadline,{className:"tgui-46dd90b57ffed25f",level:"2",weight:"3",children:s}),F&&(0,e.jsxs)(D,{className:"tgui-a894f59f4c5ad72f",children:[(0,h.hasReactNode)(p)&&(0,e.jsx)("span",{className:"tgui-1c6d7865a76a19bc",children:p}),(0,h.hasReactNode)(r)&&(0,e.jsx)("span",{className:"tgui-bb909928b48f948b",children:r}),(0,h.hasReactNode)(q)&&q]}),(0,h.hasReactNode)(t)&&(0,e.jsx)(k.Subheadline,{className:"tgui-d528ef65a8b76273",level:"2",weight:"3",children:t}),(0,h.hasReactNode)(u)&&(0,e.jsx)(E,{className:"tgui-fc059ed3ac5799a6",children:u})]}),(0,h.hasReactNode)(x)&&(0,e.jsx)("div",{className:"tgui-56b2e897ed7ccb22",children:x})]}))});a.s(["Cell",0,n],42133)},28940,a=>{"use strict";var b=a.i(95407);function c({type:a="info",children:c,className:d}){return(0,b.jsx)("div",{className:d,style:{padding:"12px 16px",color:(()=>{switch(a){case"error":return"var(--tg-theme-destructive-text-color, #ff3b30)";case"warning":return"var(--tg-theme-hint-color, #ff9500)";case"success":return"var(--tg-theme-link-color, #34c759)";default:return"var(--tg-theme-hint-color, #999999)"}})(),backgroundColor:"var(--tg-theme-secondary-bg-color, #f1f1f1)",borderRadius:"8px",margin:"8px 16px",fontSize:"14px",lineHeight:"1.4"},children:c})}a.s(["Banner",()=>c])},32383,a=>{"use strict";var b=a.i(95407);function c({amountKopeks:a,currency:c="RUB",className:d}){let e=`${(a/100).toFixed(2)} ${c}`;return(0,b.jsx)("span",{className:d,children:e})}a.s(["Price",()=>c])},19032,76918,a=>{"use strict";function b(){return null}function c(a){}async function d(a){return!1}function e(a){}async function f(a){let b=(a.headers.get("Content-Type")??"").includes("application/json"),c=b?await a.json().catch(()=>({})):await a.text();if(!a.ok){let d=Error(b&&c?.error||("string"==typeof c?c:"Request failed"));throw d.status=a.status,d.payload=c,d}return c}function g(a){let c={"Content-Type":"application/json"};if(a?.auth){let a=b();if(!a){let b=process.env.NEXT_PUBLIC_E2E_TG_INIT_DATA??process.env.E2E_TG_INIT_DATA;"string"==typeof b&&b.length>0&&(a=b)}a&&(c["x-telegram-init-data"]=a)}return a?.idempotencyKey&&(c["x-idempotency-key"]=a.idempotencyKey),c}async function h(a,b){return f(await fetch(a,{method:"GET",headers:g(b),signal:b?.signal}))}async function i(a,b,c){return f(await fetch(a,{method:"POST",headers:g(c),body:JSON.stringify(b??{}),signal:c?.signal}))}a.s(["copyToClipboard",()=>d,"getInitData",()=>b,"openExternal",()=>c,"openSupport",()=>e],76918),a.s(["apiGet",()=>h,"apiPost",()=>i],19032)},45263,a=>{"use strict";var b=a.i(95407);function c({width:a,height:c,className:d,variant:e="text"}){let f={};return a&&(f.width="number"==typeof a?`${a}px`:a),c&&(f.height="number"==typeof c?`${c}px`:c),"circular"===e&&(f.borderRadius="50%"),(0,b.jsx)("div",{className:`${"text"===e?"skeleton skeleton-text":"card"===e?"skeleton skeleton-card":"skeleton"} ${d||""}`,style:f})}a.s(["Skeleton",()=>c])},1901,a=>{"use strict";var b=a.i(95407),c=a.i(46749);a.i(62720);var d=a.i(97429),e=a.i(42133),f=a.i(75535),g=a.i(39150),h=a.i(65111),i=a.i(47132),j=a.i(74547),k=a.i(15149),l=a.i(28940),m=a.i(32383),n=a.i(45263),o=a.i(19032),p=a.i(76918);function q(){let a=(0,i.useRouter)(),q=Number((0,i.useParams)().id),[r,s]=(0,c.useState)(null),[t,u]=(0,c.useState)(!0),[v,w]=(0,c.useState)(null),x=(0,c.useMemo)(()=>r&&("PAID"===r.status||"FULFILLED"===r.status||"CANCELED"===r.status),[r]);(0,c.useEffect)(()=>{let a;if(!Number.isFinite(q)||q<=0){w("Некорректный идентификатор заказа"),u(!1);return}let b=!1,c=async()=>{try{let d=await (0,o.apiGet)(`/api/orders/${q}`,{auth:!0});if(b)return;s(d),w(null),"PAID"!==d.status&&"FULFILLED"!==d.status&&"CANCELED"!==d.status&&(a=window.setTimeout(c,1500))}catch(c){if(b)return;console.error(c);let a=c?.status;401===a||403===a?w("Недостаточно прав для просмотра заказа. Убедитесь, что вы открыли мини‑приложение тем же пользователем Telegram."):404===a?w("Заказ не найден."):w("Не удалось загрузить статус заказа. Попробуйте позже.")}finally{b||u(!1)}};return c(),()=>{b=!0,void 0!==a&&window.clearTimeout(a)}},[q]);let y=r&&("PAID"===r.status||"FULFILLED"===r.status),z=y?(0,b.jsx)(d.Button,{size:"m",mode:"filled",stretched:!0,onClick:()=>a.replace("/catalog"),children:"Вернуться в каталог"}):x?(0,b.jsx)(d.Button,{size:"m",mode:"bezeled",stretched:!0,onClick:()=>a.replace("/catalog"),children:"Вернуться в каталог"}):null;return(0,b.jsx)(j.Page,{children:(0,b.jsx)(k.AppShell,{title:`Заказ №${q}`,stickyBottom:z,children:(0,b.jsxs)(f.List,{children:[t&&(0,b.jsxs)(g.Section,{children:[(0,b.jsx)("div",{style:{padding:16,display:"flex",justifyContent:"center"},children:(0,b.jsx)(h.Spinner,{size:"m"})}),(0,b.jsx)(n.Skeleton,{variant:"card"}),(0,b.jsx)(n.Skeleton,{variant:"card"})]}),!t&&v&&(0,b.jsx)(g.Section,{children:(0,b.jsx)(l.Banner,{type:"error",children:v})}),!t&&!v&&r&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)(g.Section,{header:"Информация о заказе",children:[(0,b.jsx)(l.Banner,{type:function(a){switch(a){case"PAID":case"FULFILLED":return"success";case"CANCELED":return"error";case"AUTHORIZED":return"warning";default:return"info"}}(r.status),children:(0,b.jsx)("strong",{children:function(a){switch(a){case"NEW":return"Заказ создан, ожидание оплаты";case"PAYMENT_CREATED":return"Ожидание оплаты в банке";case"AUTHORIZED":return"Оплата авторизована, ожидается подтверждение";case"PAID":case"FULFILLED":return"Оплата получена";case"CANCELED":return"Заказ отменён";default:return a}}(r.status)})}),(0,b.jsxs)("div",{style:{padding:"8px 16px",fontSize:14},children:[(0,b.jsxs)("div",{style:{marginBottom:8},children:[(0,b.jsx)("strong",{children:"Сумма:"})," ",(0,b.jsx)(m.Price,{amountKopeks:r.totalAmountKopeks,currency:r.currency})]}),r.fulfillmentStatus&&"PAID"===r.status&&(0,b.jsxs)("div",{style:{marginTop:12},children:[(0,b.jsxs)("div",{style:{marginBottom:4},children:[(0,b.jsx)("strong",{children:"Статус выполнения:"})," ",function(a){switch(a){case"NOT_STARTED":return"Ожидание выполнения";case"PENDING":return"Выполняется...";case"SUCCESS":return"Выполнено успешно";case"FAILED":return"Ошибка выполнения";default:return a}}(r.fulfillmentStatus)]}),void 0!==r.fulfillmentAttemptCount&&r.fulfillmentAttemptCount>0&&(0,b.jsxs)("div",{style:{fontSize:12,opacity:.7,marginTop:4},children:["Попыток: ",r.fulfillmentAttemptCount]}),r.fulfillmentLastError&&(0,b.jsx)("div",{style:{marginTop:8},children:(0,b.jsxs)(l.Banner,{type:function(a){switch(a){case"SUCCESS":return"success";case"FAILED":return"error";case"PENDING":return"warning";default:return"info"}}(r.fulfillmentStatus),children:[(0,b.jsx)("strong",{children:"Ошибка:"})," ",r.fulfillmentLastError]})}),void 0!==r.fulfillmentAttemptCount&&r.fulfillmentAttemptCount>=3&&(0,b.jsx)("div",{style:{marginTop:8},children:(0,b.jsxs)(l.Banner,{type:"warning",children:["Превышено максимальное количество попыток (",r.fulfillmentAttemptCount,"). Обратитесь в поддержку."]})}),("FAILED"===r.fulfillmentStatus||void 0!==r.fulfillmentAttemptCount&&r.fulfillmentAttemptCount>=3)&&(0,b.jsx)("div",{style:{marginTop:12},children:(0,b.jsx)(d.Button,{size:"m",mode:"bezeled",stretched:!0,onClick:async()=>{let a=`Заказ #${r.id}
Статус: ${r.status}
Статус выполнения: ${r.fulfillmentStatus||"N/A"}
Попыток: ${r.fulfillmentAttemptCount||0}${r.fulfillmentLastError?`
Ошибка: ${r.fulfillmentLastError}`:""}`;await (0,p.copyToClipboard)(a),(0,p.openSupport)(a)},children:"Написать в поддержку"})})]})]})]}),r.items.length>0&&(0,b.jsx)(g.Section,{header:"Товары",children:r.items.map(a=>(0,b.jsx)(e.Cell,{subtitle:(0,b.jsxs)("span",{children:[a.qty," × ",(0,b.jsx)(m.Price,{amountKopeks:a.priceKopeks,currency:r.currency})]}),children:a.title},a.id))}),y&&(0,b.jsx)(g.Section,{children:(0,b.jsx)(l.Banner,{type:"success",children:"Оплата получена. Спасибо за покупку!"})})]})]})})})}a.s(["default",()=>q])}];

//# sourceMappingURL=%5Broot-of-the-server%5D__ab2082fe._.js.map