{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///Users/aleksandrivashchenko/Desktop/MVP/src/css/classnames.ts"],"sourcesContent":["export function isRecord(v: unknown): v is Record<string, unknown> {\n  return !!v && typeof v === 'object' && !Array.isArray(v);\n}\n\n/**\n * Function which joins passed values with space following these rules:\n * 1. If value is non-empty string, it will be added to output.\n * 2. If value is object, only those keys will be added, which values are truthy.\n * 3. If value is array, classNames will be called with this value spread.\n * 4. All other values are ignored.\n *\n * You can find this function to similar one from the package {@link https://www.npmjs.com/package/classnames|classnames}.\n * @param values - values array.\n * @returns Final class name.\n */\nexport function classNames(...values: any[]): string {\n  return values\n    .map((value) => {\n      if (typeof value === 'string') {\n        return value;\n      }\n\n      if (isRecord(value)) {\n        return classNames(\n          Object.entries(value).map((entry) => entry[1] && entry[0]),\n        );\n      }\n\n      if (Array.isArray(value)) {\n        return classNames(...value);\n      }\n    })\n    .filter(Boolean)\n    .join(' ');\n}\n\ntype UnionStringKeys<U> = U extends U\n  ? { [K in keyof U]-?: U[K] extends string | undefined ? K : never }[keyof U]\n  : never;\n\ntype UnionRequiredKeys<U> = U extends U\n  ? {\n      [K in UnionStringKeys<U>]: object extends Pick<U, K> ? never : K;\n    }[UnionStringKeys<U>]\n  : never;\n\ntype UnionOptionalKeys<U> = Exclude<UnionStringKeys<U>, UnionRequiredKeys<U>>;\n\nexport type MergeClassNames<Tuple extends any[]> =\n  // Removes all types from union that will be ignored by the mergeClassNames function.\n  Exclude<\n    Tuple[number],\n    number | string | null | undefined | any[] | boolean\n  > extends infer Union\n    ? { [K in UnionRequiredKeys<Union>]: string } & {\n        [K in UnionOptionalKeys<Union>]?: string;\n      }\n    : never;\n\n/**\n * Merges two sets of classnames.\n *\n * The function expects to pass an array of objects with values that could be passed to\n * the `classNames` function.\n * @returns An object with keys from all objects with merged values.\n * @see classNames\n */\nexport function mergeClassNames<T extends any[]>(\n  ...partials: T\n): MergeClassNames<T> {\n  return partials.reduce<MergeClassNames<T>>((acc, partial) => {\n    if (isRecord(partial)) {\n      Object.entries(partial).forEach(([key, value]) => {\n        const className = classNames((acc as any)[key], value);\n        if (className) {\n          (acc as any)[key] = className;\n        }\n      });\n    }\n    return acc;\n  }, {} as MergeClassNames<T>);\n}\n"],"names":[],"mappings":";;;;;;;;AAAO,SAAS,SAAS,CAAU;IACjC,OAAO,CAAC,CAAC,KAAK,OAAO,MAAM,YAAY,CAAC,MAAM,OAAO,CAAC;AACxD;AAaO,SAAS,WAAW,GAAG,MAAa;IACzC,OAAO,OACJ,GAAG,CAAC,CAAC;QACJ,IAAI,OAAO,UAAU,UAAU;YAC7B,OAAO;QACT;QAEA,IAAI,SAAS,QAAQ;YACnB,OAAO,WACL,OAAO,OAAO,CAAC,OAAO,GAAG,CAAC,CAAC,QAAU,KAAK,CAAC,EAAE,IAAI,KAAK,CAAC,EAAE;QAE7D;QAEA,IAAI,MAAM,OAAO,CAAC,QAAQ;YACxB,OAAO,cAAc;QACvB;IACF,GACC,MAAM,CAAC,SACP,IAAI,CAAC;AACV;AAiCO,SAAS,gBACd,GAAG,QAAW;IAEd,OAAO,SAAS,MAAM,CAAqB,CAAC,KAAK;QAC/C,IAAI,SAAS,UAAU;YACrB,OAAO,OAAO,CAAC,SAAS,OAAO,CAAC,CAAC,CAAC,KAAK,MAAM;gBAC3C,MAAM,YAAY,WAAW,AAAC,GAAW,CAAC,IAAI,EAAE;gBAChD,IAAI,WAAW;oBACZ,GAAW,CAAC,IAAI,GAAG;gBACtB;YACF;QACF;QACA,OAAO;IACT,GAAG,CAAC;AACN"}},
    {"offset": {"line": 48, "column": 0}, "map": {"version":3,"sources":["file:///Users/aleksandrivashchenko/Desktop/MVP/src/components/Link/Link.tsx"],"sourcesContent":["import { openLink } from '@tma.js/sdk-react';\nimport { type FC, type MouseEventHandler, type JSX, useCallback } from 'react';\nimport {\n  type LinkProps as NextLinkProps,\n  default as NextLink,\n} from 'next/link';\n\nimport { classNames } from '@/css/classnames';\n\nimport './Link.css';\n\nexport interface LinkProps\n  extends NextLinkProps,\n    Omit<JSX.IntrinsicElements['a'], 'href'> {}\n\nexport const Link: FC<LinkProps> = ({\n  className,\n  onClick: propsOnClick,\n  href,\n  ...rest\n}) => {\n  const onClick = useCallback<MouseEventHandler<HTMLAnchorElement>>(\n    (e) => {\n      propsOnClick?.(e);\n\n      // Compute if target path is external. In this case we would like to open link using\n      // TMA method.\n      let path: string;\n      if (typeof href === 'string') {\n        path = href;\n      } else {\n        const { search = '', pathname = '', hash = '' } = href;\n        path = `${pathname}?${search}#${hash}`;\n      }\n\n      const targetUrl = new URL(path, window.location.toString());\n      const currentUrl = new URL(window.location.toString());\n      const isExternal =\n        targetUrl.protocol !== currentUrl.protocol ||\n        targetUrl.host !== currentUrl.host;\n\n      if (isExternal) {\n        e.preventDefault();\n        openLink(targetUrl.toString());\n      }\n    },\n    [href, propsOnClick],\n  );\n\n  return (\n    <NextLink\n      {...rest}\n      href={href}\n      onClick={onClick}\n      className={classNames(className, 'link')}\n    />\n  );\n};\n"],"names":[],"mappings":";;;;;AAAA;AACA;AACA;AAKA;;;;;;;;AAQO,MAAM,OAAsB,CAAC,EAClC,SAAS,EACT,SAAS,YAAY,EACrB,IAAI,EACJ,GAAG,MACJ;;IACC,MAAM,UAAU,IAAA,oXAAW;qCACzB,CAAC;YACC,eAAe;YAEf,oFAAoF;YACpF,cAAc;YACd,IAAI;YACJ,IAAI,OAAO,SAAS,UAAU;gBAC5B,OAAO;YACT,OAAO;gBACL,MAAM,EAAE,SAAS,EAAE,EAAE,WAAW,EAAE,EAAE,OAAO,EAAE,EAAE,GAAG;gBAClD,OAAO,GAAG,SAAS,CAAC,EAAE,OAAO,CAAC,EAAE,MAAM;YACxC;YAEA,MAAM,YAAY,IAAI,IAAI,MAAM,OAAO,QAAQ,CAAC,QAAQ;YACxD,MAAM,aAAa,IAAI,IAAI,OAAO,QAAQ,CAAC,QAAQ;YACnD,MAAM,aACJ,UAAU,QAAQ,KAAK,WAAW,QAAQ,IAC1C,UAAU,IAAI,KAAK,WAAW,IAAI;YAEpC,IAAI,YAAY;gBACd,EAAE,cAAc;gBAChB,IAAA,2QAAQ,EAAC,UAAU,QAAQ;YAC7B;QACF;oCACA;QAAC;QAAM;KAAa;IAGtB,qBACE,qYAAC,kXAAQ;QACN,GAAG,IAAI;QACR,MAAM;QACN,SAAS;QACT,WAAW,IAAA,yIAAU,EAAC,WAAW;;;;;;AAGvC;GA1Ca;KAAA"}},
    {"offset": {"line": 112, "column": 0}, "map": {"version":3,"sources":["file:///Users/aleksandrivashchenko/Desktop/MVP/src/components/Page.tsx"],"sourcesContent":["'use client';\n\nimport { backButton } from '@tma.js/sdk-react';\nimport { PropsWithChildren, useEffect } from 'react';\nimport { useRouter } from 'next/navigation';\n\nexport function Page({ children, back = true }: PropsWithChildren<{\n  /**\n   * True if it is allowed to go back from this page.\n   * @default true\n   */\n  back?: boolean\n}>) {\n  const router = useRouter();\n\n  useEffect(() => {\n    if (back) {\n      backButton.show();\n    } else {\n      backButton.hide();\n    }\n  }, [back]);\n\n  useEffect(() => {\n    return backButton.onClick(() => {\n      router.back();\n    });\n  }, [router]);\n\n  return <>{children}</>;\n}\n"],"names":[],"mappings":";;;;;AAEA;AACA;AACA;;;AAJA;;;;AAMO,SAAS,KAAK,EAAE,QAAQ,EAAE,OAAO,IAAI,EAM1C;;IACA,MAAM,SAAS,IAAA,0VAAS;IAExB,IAAA,kXAAS;0BAAC;YACR,IAAI,MAAM;gBACR,6QAAU,CAAC,IAAI;YACjB,OAAO;gBACL,6QAAU,CAAC,IAAI;YACjB;QACF;yBAAG;QAAC;KAAK;IAET,IAAA,kXAAS;0BAAC;YACR,OAAO,6QAAU,CAAC,OAAO;kCAAC;oBACxB,OAAO,IAAI;gBACb;;QACF;yBAAG;QAAC;KAAO;IAEX,qBAAO;kBAAG;;AACZ;GAxBgB;;QAOC,0VAAS;;;KAPV"}},
    {"offset": {"line": 170, "column": 0}, "map": {"version":3,"sources":["file:///Users/aleksandrivashchenko/Desktop/MVP/src/lib/tg.ts"],"sourcesContent":["'use client';\n\nexport function getInitData(): string | null {\n  if (typeof window === 'undefined') {\n    return null;\n  }\n\n  // Prefer real Telegram WebApp initData if available.\n  const tg = (window as any).Telegram;\n  const initData: string | undefined = tg?.WebApp?.initData;\n\n  if (initData && typeof initData === 'string' && initData.length > 0) {\n    return initData;\n  }\n\n  // Fallback: allow passing initData via search param during local development.\n  const url = new URL(window.location.href);\n  const fromQuery = url.searchParams.get('initData');\n\n  return fromQuery && fromQuery.length > 0 ? fromQuery : null;\n}\n\nexport function openExternal(url: string): void {\n  if (typeof window === 'undefined') {\n    return;\n  }\n\n  try {\n    const tg = (window as any).Telegram;\n    const webApp = tg?.WebApp;\n\n    if (webApp && typeof webApp.openLink === 'function') {\n      webApp.openLink(url);\n      return;\n    }\n  } catch {\n    // Ignore and fallback to window.open.\n  }\n\n  window.open(url, '_blank', 'noopener,noreferrer');\n}\n\n\n"],"names":[],"mappings":";;;;;;AAAA;AAEO,SAAS;IACd;;IAIA,qDAAqD;IACrD,MAAM,KAAK,AAAC,OAAe,QAAQ;IACnC,MAAM,WAA+B,IAAI,QAAQ;IAEjD,IAAI,YAAY,OAAO,aAAa,YAAY,SAAS,MAAM,GAAG,GAAG;QACnE,OAAO;IACT;IAEA,8EAA8E;IAC9E,MAAM,MAAM,IAAI,IAAI,OAAO,QAAQ,CAAC,IAAI;IACxC,MAAM,YAAY,IAAI,YAAY,CAAC,GAAG,CAAC;IAEvC,OAAO,aAAa,UAAU,MAAM,GAAG,IAAI,YAAY;AACzD;AAEO,SAAS,aAAa,GAAW;IACtC;;IAIA,IAAI;QACF,MAAM,KAAK,AAAC,OAAe,QAAQ;QACnC,MAAM,SAAS,IAAI;QAEnB,IAAI,UAAU,OAAO,OAAO,QAAQ,KAAK,YAAY;YACnD,OAAO,QAAQ,CAAC;YAChB;QACF;IACF,EAAE,OAAM;IACN,sCAAsC;IACxC;IAEA,OAAO,IAAI,CAAC,KAAK,UAAU;AAC7B"}},
    {"offset": {"line": 213, "column": 0}, "map": {"version":3,"sources":["file:///Users/aleksandrivashchenko/Desktop/MVP/src/lib/api.ts"],"sourcesContent":["import { getInitData } from './tg';\n\ntype ApiOptions = {\n  auth?: boolean;\n  signal?: AbortSignal;\n  idempotencyKey?: string;\n};\n\nasync function handleResponse<T>(res: Response): Promise<T> {\n  const contentType = res.headers.get('Content-Type') ?? '';\n  const isJson = contentType.includes('application/json');\n  const payload = isJson ? await res.json().catch(() => ({})) : await res.text();\n\n  if (!res.ok) {\n    const message =\n      (isJson && (payload as any)?.error) ||\n      (typeof payload === 'string' ? payload : 'Request failed');\n\n    const error = new Error(message);\n    (error as any).status = res.status;\n    (error as any).payload = payload;\n    throw error;\n  }\n\n  return payload as T;\n}\n\nfunction buildHeaders(options?: ApiOptions): HeadersInit {\n  const headers: HeadersInit = {\n    'Content-Type': 'application/json',\n  };\n\n  if (options?.auth) {\n    let initData = getInitData();\n\n    // In E2E / test mode we can provide initData via compile-time env.\n    if (!initData) {\n      const testInitData =\n        process.env.NEXT_PUBLIC_E2E_TG_INIT_DATA ?? process.env.E2E_TG_INIT_DATA;\n      if (typeof testInitData === 'string' && testInitData.length > 0) {\n        initData = testInitData;\n      }\n    }\n\n    if (initData) {\n      (headers as Record<string, string>)['x-telegram-init-data'] = initData;\n    }\n  }\n\n  if (options?.idempotencyKey) {\n    (headers as Record<string, string>)['x-idempotency-key'] = options.idempotencyKey;\n  }\n\n  return headers;\n}\n\nexport async function apiGet<T>(url: string, options?: ApiOptions): Promise<T> {\n  const res = await fetch(url, {\n    method: 'GET',\n    headers: buildHeaders(options),\n    signal: options?.signal,\n  });\n\n  return handleResponse<T>(res);\n}\n\nexport async function apiPost<T>(\n  url: string,\n  body: unknown,\n  options?: ApiOptions,\n): Promise<T> {\n  const res = await fetch(url, {\n    method: 'POST',\n    headers: buildHeaders(options),\n    body: JSON.stringify(body ?? {}),\n    signal: options?.signal,\n  });\n\n  return handleResponse<T>(res);\n}\n\n\n"],"names":[],"mappings":";;;;;;AAsCQ;AAtCR;;AAQA,eAAe,eAAkB,GAAa;IAC5C,MAAM,cAAc,IAAI,OAAO,CAAC,GAAG,CAAC,mBAAmB;IACvD,MAAM,SAAS,YAAY,QAAQ,CAAC;IACpC,MAAM,UAAU,SAAS,MAAM,IAAI,IAAI,GAAG,KAAK,CAAC,IAAM,CAAC,CAAC,CAAC,KAAK,MAAM,IAAI,IAAI;IAE5E,IAAI,CAAC,IAAI,EAAE,EAAE;QACX,MAAM,UACJ,AAAC,UAAW,SAAiB,SAC7B,CAAC,OAAO,YAAY,WAAW,UAAU,gBAAgB;QAE3D,MAAM,QAAQ,IAAI,MAAM;QACvB,MAAc,MAAM,GAAG,IAAI,MAAM;QACjC,MAAc,OAAO,GAAG;QACzB,MAAM;IACR;IAEA,OAAO;AACT;AAEA,SAAS,aAAa,OAAoB;IACxC,MAAM,UAAuB;QAC3B,gBAAgB;IAClB;IAEA,IAAI,SAAS,MAAM;QACjB,IAAI,WAAW,IAAA,kIAAW;QAE1B,mEAAmE;QACnE,IAAI,CAAC,UAAU;YACb,MAAM,eACJ,6EAA4C,mXAAO,CAAC,GAAG,CAAC,gBAAgB;YAC1E,IAAI,OAAO,iBAAiB,YAAY,aAAa,MAAM,GAAG,GAAG;gBAC/D,WAAW;YACb;QACF;QAEA,IAAI,UAAU;YACX,OAAkC,CAAC,uBAAuB,GAAG;QAChE;IACF;IAEA,IAAI,SAAS,gBAAgB;QAC1B,OAAkC,CAAC,oBAAoB,GAAG,QAAQ,cAAc;IACnF;IAEA,OAAO;AACT;AAEO,eAAe,OAAU,GAAW,EAAE,OAAoB;IAC/D,MAAM,MAAM,MAAM,MAAM,KAAK;QAC3B,QAAQ;QACR,SAAS,aAAa;QACtB,QAAQ,SAAS;IACnB;IAEA,OAAO,eAAkB;AAC3B;AAEO,eAAe,QACpB,GAAW,EACX,IAAa,EACb,OAAoB;IAEpB,MAAM,MAAM,MAAM,MAAM,KAAK;QAC3B,QAAQ;QACR,SAAS,aAAa;QACtB,MAAM,KAAK,SAAS,CAAC,QAAQ,CAAC;QAC9B,QAAQ,SAAS;IACnB;IAEA,OAAO,eAAkB;AAC3B"}},
    {"offset": {"line": 281, "column": 0}, "map": {"version":3,"sources":["file:///Users/aleksandrivashchenko/Desktop/MVP/src/lib/cart.ts"],"sourcesContent":["export type CartItem = {\n  productId: number;\n  qty: number;\n};\n\nconst STORAGE_KEY = 'cart:v1';\n\nconst CART_EVENT_NAME = 'cart:changed';\n\nfunction assertValidCart(items: CartItem[]): void {\n  if (process.env.NODE_ENV === 'production') {\n    return;\n  }\n\n  const invalid = items.find((i) => !Number.isFinite(i.qty) || i.qty <= 0);\n  if (invalid) {\n    // Dev-only assertion to ensure we never keep zero/negative qty in cart.\n    // eslint-disable-next-line no-console\n    console.error('Invalid cart state detected (qty must be >= 1):', items);\n    throw new Error('Invalid cart state: qty must be >= 1');\n  }\n}\n\nfunction dispatchCartChanged(items: CartItem[]): void {\n  if (typeof window === 'undefined') {\n    return;\n  }\n\n  try {\n    const event = new CustomEvent<CartItem[]>(CART_EVENT_NAME, { detail: items });\n    window.dispatchEvent(event);\n  } catch {\n    // Ignore event dispatch errors.\n  }\n}\n\nfunction readStorage(): CartItem[] {\n  if (typeof window === 'undefined') {\n    return [];\n  }\n\n  try {\n    const raw = window.localStorage.getItem(STORAGE_KEY);\n    if (!raw) return [];\n\n    const parsed = JSON.parse(raw) as unknown;\n    if (!Array.isArray(parsed)) return [];\n\n    return parsed\n      .map((item) => ({\n        productId: Number((item as any).productId),\n        qty: Number((item as any).qty),\n      }))\n      .filter((i) => Number.isFinite(i.productId) && i.productId > 0 && i.qty > 0);\n  } catch {\n    return [];\n  }\n}\n\nfunction writeStorage(items: CartItem[]): void {\n  if (typeof window === 'undefined') {\n    return;\n  }\n\n  try {\n    assertValidCart(items);\n    window.localStorage.setItem(STORAGE_KEY, JSON.stringify(items));\n  } catch {\n    // Ignore storage errors.\n  }\n}\n\nexport function getCart(): CartItem[] {\n  return readStorage();\n}\n\nexport function setCart(items: CartItem[]): void {\n  writeStorage(items);\n  dispatchCartChanged(items);\n}\n\nexport function addToCart(productId: number, qty: number = 1): CartItem[] {\n  const items = readStorage();\n  const existing = items.find((i) => i.productId === productId);\n\n  if (existing) {\n    existing.qty += qty;\n  } else {\n    const safeQty = Math.max(1, Math.floor(qty));\n    items.push({ productId, qty: safeQty });\n  }\n\n  writeStorage(items);\n  dispatchCartChanged(items);\n  return items;\n}\n\nexport function updateQty(productId: number, qty: number): CartItem[] {\n  let items = readStorage();\n\n  if (qty <= 0) {\n    items = items.filter((i) => i.productId !== productId);\n  } else {\n    const safeQty = Math.max(1, Math.floor(qty));\n    items = items.map((i) => (i.productId === productId ? { ...i, qty: safeQty } : i));\n  }\n\n  writeStorage(items);\n  dispatchCartChanged(items);\n  return items;\n}\n\nexport function remove(productId: number): CartItem[] {\n  const items = readStorage().filter((i) => i.productId !== productId);\n  writeStorage(items);\n  dispatchCartChanged(items);\n  return items;\n}\n\nexport function clear(): void {\n  if (typeof window === 'undefined') {\n    return;\n  }\n  try {\n    window.localStorage.removeItem(STORAGE_KEY);\n    dispatchCartChanged([]);\n  } catch {\n    // Ignore.\n  }\n}\n\n\n"],"names":[],"mappings":";;;;;;;;;;;;;;AAUM;AALN,MAAM,cAAc;AAEpB,MAAM,kBAAkB;AAExB,SAAS,gBAAgB,KAAiB;IACxC;;IAIA,MAAM,UAAU,MAAM,IAAI,CAAC,CAAC,IAAM,CAAC,OAAO,QAAQ,CAAC,EAAE,GAAG,KAAK,EAAE,GAAG,IAAI;IACtE,IAAI,SAAS;QACX,wEAAwE;QACxE,sCAAsC;QACtC,QAAQ,KAAK,CAAC,mDAAmD;QACjE,MAAM,IAAI,MAAM;IAClB;AACF;AAEA,SAAS,oBAAoB,KAAiB;IAC5C;;IAIA,IAAI;QACF,MAAM,QAAQ,IAAI,YAAwB,iBAAiB;YAAE,QAAQ;QAAM;QAC3E,OAAO,aAAa,CAAC;IACvB,EAAE,OAAM;IACN,gCAAgC;IAClC;AACF;AAEA,SAAS;IACP;;IAIA,IAAI;QACF,MAAM,MAAM,OAAO,YAAY,CAAC,OAAO,CAAC;QACxC,IAAI,CAAC,KAAK,OAAO,EAAE;QAEnB,MAAM,SAAS,KAAK,KAAK,CAAC;QAC1B,IAAI,CAAC,MAAM,OAAO,CAAC,SAAS,OAAO,EAAE;QAErC,OAAO,OACJ,GAAG,CAAC,CAAC,OAAS,CAAC;gBACd,WAAW,OAAO,AAAC,KAAa,SAAS;gBACzC,KAAK,OAAO,AAAC,KAAa,GAAG;YAC/B,CAAC,GACA,MAAM,CAAC,CAAC,IAAM,OAAO,QAAQ,CAAC,EAAE,SAAS,KAAK,EAAE,SAAS,GAAG,KAAK,EAAE,GAAG,GAAG;IAC9E,EAAE,OAAM;QACN,OAAO,EAAE;IACX;AACF;AAEA,SAAS,aAAa,KAAiB;IACrC;;IAIA,IAAI;QACF,gBAAgB;QAChB,OAAO,YAAY,CAAC,OAAO,CAAC,aAAa,KAAK,SAAS,CAAC;IAC1D,EAAE,OAAM;IACN,yBAAyB;IAC3B;AACF;AAEO,SAAS;IACd,OAAO;AACT;AAEO,SAAS,QAAQ,KAAiB;IACvC,aAAa;IACb,oBAAoB;AACtB;AAEO,SAAS,UAAU,SAAiB,EAAE,MAAc,CAAC;IAC1D,MAAM,QAAQ;IACd,MAAM,WAAW,MAAM,IAAI,CAAC,CAAC,IAAM,EAAE,SAAS,KAAK;IAEnD,IAAI,UAAU;QACZ,SAAS,GAAG,IAAI;IAClB,OAAO;QACL,MAAM,UAAU,KAAK,GAAG,CAAC,GAAG,KAAK,KAAK,CAAC;QACvC,MAAM,IAAI,CAAC;YAAE;YAAW,KAAK;QAAQ;IACvC;IAEA,aAAa;IACb,oBAAoB;IACpB,OAAO;AACT;AAEO,SAAS,UAAU,SAAiB,EAAE,GAAW;IACtD,IAAI,QAAQ;IAEZ,IAAI,OAAO,GAAG;QACZ,QAAQ,MAAM,MAAM,CAAC,CAAC,IAAM,EAAE,SAAS,KAAK;IAC9C,OAAO;QACL,MAAM,UAAU,KAAK,GAAG,CAAC,GAAG,KAAK,KAAK,CAAC;QACvC,QAAQ,MAAM,GAAG,CAAC,CAAC,IAAO,EAAE,SAAS,KAAK,YAAY;gBAAE,GAAG,CAAC;gBAAE,KAAK;YAAQ,IAAI;IACjF;IAEA,aAAa;IACb,oBAAoB;IACpB,OAAO;AACT;AAEO,SAAS,OAAO,SAAiB;IACtC,MAAM,QAAQ,cAAc,MAAM,CAAC,CAAC,IAAM,EAAE,SAAS,KAAK;IAC1D,aAAa;IACb,oBAAoB;IACpB,OAAO;AACT;AAEO,SAAS;IACd;;IAGA,IAAI;QACF,OAAO,YAAY,CAAC,UAAU,CAAC;QAC/B,oBAAoB,EAAE;IACxB,EAAE,OAAM;IACN,UAAU;IACZ;AACF"}},
    {"offset": {"line": 408, "column": 0}, "map": {"version":3,"sources":["file:///Users/aleksandrivashchenko/Desktop/MVP/src/app/catalog/page.tsx"],"sourcesContent":["'use client';\n\nimport { useEffect, useMemo, useState } from 'react';\nimport { Button, Cell, Footer, Group, Header, List, Spinner } from '@telegram-apps/telegram-ui';\n\nimport { Link } from '@/components/Link/Link';\nimport { Page } from '@/components/Page';\nimport { apiGet } from '@/lib/api';\nimport { addToCart, getCart } from '@/lib/cart';\n\ntype ProductDto = {\n  id: number;\n  title: string;\n  description?: string | null;\n  priceKopeks: number;\n  currency: string;\n  available: boolean;\n  imageUrl?: string | null;\n};\n\nfunction formatPrice(amountKopeks: number, currency: string): string {\n  const rub = amountKopeks / 100;\n  return `${rub.toFixed(2)} ${currency}`;\n}\n\nexport default function CatalogPage() {\n  const [products, setProducts] = useState<ProductDto[]>([]);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState<string | null>(null);\n  const [cartCount, setCartCount] = useState(0);\n\n  useEffect(() => {\n    setCartCount(getCart().reduce((sum, i) => sum + i.qty, 0));\n  }, []);\n\n  useEffect(() => {\n    let cancelled = false;\n\n    (async () => {\n      try {\n        const data = await apiGet<ProductDto[]>('/api/products');\n        if (!cancelled) {\n          setProducts(data);\n          setError(null);\n        }\n      } catch (e) {\n        console.error(e);\n        if (!cancelled) {\n          setError('Не удалось загрузить каталог');\n        }\n      } finally {\n        if (!cancelled) {\n          setLoading(false);\n        }\n      }\n    })();\n\n    return () => {\n      cancelled = true;\n    };\n  }, []);\n\n  const hasProducts = useMemo(() => products.length > 0, [products]);\n\n  const handleAdd = (productId: number) => {\n    const items = addToCart(productId, 1);\n    setCartCount(items.reduce((sum, i) => sum + i.qty, 0));\n  };\n\n  return (\n    <Page>\n      <Group\n        header={\n          <Header\n            subtitle={hasProducts ? 'Выберите товары' : undefined}\n          >\n            Каталог\n          </Header>\n        }\n      >\n        {loading && (\n          <div style={{ padding: 16, display: 'flex', justifyContent: 'center' }}>\n            <Spinner size=\"m\" />\n          </div>\n        )}\n\n        {!loading && error && (\n          <div style={{ padding: 16, color: 'var(--tgui--color-destructive)' }}>{error}</div>\n        )}\n\n        {!loading && !error && !hasProducts && (\n          <div style={{ padding: 16 }}>Список товаров пуст.</div>\n        )}\n\n        {!loading && !error && hasProducts && (\n          <List>\n            {products.map((p) => (\n              <Cell\n                key={p.id}\n                subtitle={formatPrice(p.priceKopeks, p.currency)}\n                after={\n                  <Button\n                    size=\"s\"\n                    mode=\"bezeled\"\n                    onClick={() => handleAdd(p.id)}\n                    disabled={!p.available}\n                  >\n                    Добавить\n                  </Button>\n                }\n              >\n                {p.title}\n              </Cell>\n            ))}\n          </List>\n        )}\n\n        <Footer>\n          <Link href=\"/cart\">\n            Корзина {cartCount > 0 ? `(${cartCount})` : ''}\n          </Link>\n        </Footer>\n      </Group>\n    </Page>\n  );\n}\n\n\n"],"names":[],"mappings":";;;;;AAEA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AACA;AACA;AACA;;;AARA;;;;;;;AAoBA,SAAS,YAAY,YAAoB,EAAE,QAAgB;IACzD,MAAM,MAAM,eAAe;IAC3B,OAAO,GAAG,IAAI,OAAO,CAAC,GAAG,CAAC,EAAE,UAAU;AACxC;AAEe,SAAS;;IACtB,MAAM,CAAC,UAAU,YAAY,GAAG,IAAA,iXAAQ,EAAe,EAAE;IACzD,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,iXAAQ,EAAC;IACvC,MAAM,CAAC,OAAO,SAAS,GAAG,IAAA,iXAAQ,EAAgB;IAClD,MAAM,CAAC,WAAW,aAAa,GAAG,IAAA,iXAAQ,EAAC;IAE3C,IAAA,kXAAS;iCAAC;YACR,aAAa,IAAA,gIAAO,IAAG,MAAM;yCAAC,CAAC,KAAK,IAAM,MAAM,EAAE,GAAG;wCAAE;QACzD;gCAAG,EAAE;IAEL,IAAA,kXAAS;iCAAC;YACR,IAAI,YAAY;YAEhB;yCAAC;oBACC,IAAI;wBACF,MAAM,OAAO,MAAM,AAFvB,IAEuB,8HAAM,AAe5B,EAf2C;wBACxC,IAAI,CAAC,WAAW;4BACd,YAAY;4BACZ,SAAS;wBACX;oBACF,EAAE,OAAO,GAAG;wBACV,QAAQ,KAAK,CAAC;wBACd,IAAI,CAAC,WAAW;4BACd,SAAS;wBACX;oBACF,SAAU;wBACR,IAAI,CAAC,WAAW;4BACd,WAAW;wBACb;oBACF;gBACF;;YAEA;yCAAO;oBACL,YAAY;gBACd;;QACF;gCAAG,EAAE;IAEL,MAAM,cAAc,IAAA,gXAAO;4CAAC,IAAM,SAAS,MAAM,GAAG;2CAAG;QAAC;KAAS;IAEjE,MAAM,YAAY,CAAC;QACjB,MAAM,QAAQ,IAAA,kIAAS,EAAC,WAAW;QACnC,aAAa,MAAM,MAAM,CAAC,CAAC,KAAK,IAAM,MAAM,EAAE,GAAG,EAAE;IACrD;IAEA,qBACE,qYAAC,qIAAI;kBACH,cAAA,qYAAC,kYAAK;YACJ,sBACE,qYAAC,mYAAM;gBACL,UAAU,cAAc,oBAAoB;0BAC7C;;;;;;;gBAKF,yBACC,qYAAC;oBAAI,OAAO;wBAAE,SAAS;wBAAI,SAAS;wBAAQ,gBAAgB;oBAAS;8BACnE,cAAA,qYAAC,2aAAO;wBAAC,MAAK;;;;;;;;;;;gBAIjB,CAAC,WAAW,uBACX,qYAAC;oBAAI,OAAO;wBAAE,SAAS;wBAAI,OAAO;oBAAiC;8BAAI;;;;;;gBAGxE,CAAC,WAAW,CAAC,SAAS,CAAC,6BACtB,qYAAC;oBAAI,OAAO;wBAAE,SAAS;oBAAG;8BAAG;;;;;;gBAG9B,CAAC,WAAW,CAAC,SAAS,6BACrB,qYAAC,gaAAI;8BACF,SAAS,GAAG,CAAC,CAAC,kBACb,qYAAC,gaAAI;4BAEH,UAAU,YAAY,EAAE,WAAW,EAAE,EAAE,QAAQ;4BAC/C,qBACE,qYAAC,saAAM;gCACL,MAAK;gCACL,MAAK;gCACL,SAAS,IAAM,UAAU,EAAE,EAAE;gCAC7B,UAAU,CAAC,EAAE,SAAS;0CACvB;;;;;;sCAKF,EAAE,KAAK;2BAbH,EAAE,EAAE;;;;;;;;;;8BAmBjB,qYAAC,mYAAM;8BACL,cAAA,qYAAC,6IAAI;wBAAC,MAAK;;4BAAQ;4BACR,YAAY,IAAI,CAAC,CAAC,EAAE,UAAU,CAAC,CAAC,GAAG;;;;;;;;;;;;;;;;;;;;;;;AAMxD;GApGwB;KAAA"}}]
}